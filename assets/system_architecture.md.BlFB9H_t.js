import{_ as l,C as o,o as i,c as r,j as e,a,b as p,w as t,E as d,a4 as h,a2 as c}from"./chunks/framework.DV8_IVTo.js";const v=JSON.parse('{"title":"Vitals System Architecture","description":"Technical architecture of Vitals VS Code extension - webview components, Prometheus integration, data flow, and system design.","frontmatter":{"title":"Vitals System Architecture","description":"Technical architecture of Vitals VS Code extension - webview components, Prometheus integration, data flow, and system design.","head":[["meta",{"name":"keywords","content":"system architecture, technical design, VS Code webview, Prometheus API, React components, extension architecture"}]]},"headers":[],"relativePath":"system_architecture.md","filePath":"system_architecture.md","lastUpdated":1765184252000}'),k={name:"system_architecture.md"};function u(E,s,g,m,y,b){const n=o("Mermaid");return i(),r("div",null,[s[1]||(s[1]=e("h1",{id:"architecture",tabindex:"-1"},[a("Architecture "),e("a",{class:"header-anchor",href:"#architecture","aria-label":'Permalink to "Architecture"'},"​")],-1)),s[2]||(s[2]=e("h2",{id:"overview",tabindex:"-1"},[a("Overview "),e("a",{class:"header-anchor",href:"#overview","aria-label":'Permalink to "Overview"'},"​")],-1)),s[3]||(s[3]=e("p",null,"Vitals is a VS Code extension that provides real-time monitoring of application metrics and logs from Prometheus, integrated directly into the editor.",-1)),(i(),p(h,null,{default:t(()=>[d(n,{id:"mermaid-9",class:"mermaid my-class",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20%22VS%20Code%20Extension%20Host%20(Node.js)%22%0A%20%20%20%20%20%20%20%20Ext%5Bextension.ts%5D%20--%3E%7CActivates%7C%20PV%5BView.ts%5D%0A%20%20%20%20%20%20%20%20PV%20--%3E%7CUses%7C%20API%5Bapi.ts%5D%0A%20%20%20%20%20%20%20%20PV%20--%3E%7CManages%7C%20Panel%5BWebviewPanel%5D%0A%0A%20%20%20%20%20%20%20%20subgraph%20%22Data%20Layer%22%0A%20%20%20%20%20%20%20%20%20%20%20%20API%20--%3E%7CHTTP%20GET%7C%20Prom%5BPrometheus%20Server%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20AP%5BalertProcessor.ts%5D%20--%3E%7CProcess%7C%20API%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20%22Webview%20(React%2FBrowser)%22%0A%20%20%20%20%20%20%20%20Panel%20---%7CIPC%20Messages%7C%20App%5BApp.tsx%5D%0A%20%20%20%20%20%20%20%20App%20--%3E%7CRenders%7C%20Dash%5BDashboard.tsx%5D%0A%0A%20%20%20%20%20%20%20%20subgraph%20%22Components%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Dash%20--%3E%20Chart%5BMetricChart.tsx%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20Dash%20--%3E%20Logs%5BLogViewer.tsx%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20Dash%20--%3E%20Alerts%5BAlertPanel.tsx%5D%0A%20%20%20%20%20%20%20%20end%0A%0A%20%20%20%20%20%20%20%20subgraph%20%22Hooks%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Chart%20--%3E%7CuseData%7C%20Hook1%5BuseData.ts%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20Logs%20--%3E%7CuseData%7C%20Hook1%0A%20%20%20%20%20%20%20%20%20%20%20%20Alerts%20--%3E%7CuseAlerts%7C%20Hook2%5BuseAlerts.ts%5D%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0A%0A%20%20%20%20Hook1%20-.-%3E%7CpostMessage%7C%20PV%0A%20%20%20%20Hook2%20-.-%3E%7CpostMessage%7C%20PV%0A%20%20%20%20PV%20-.-%3E%7CupdateMetrics%2FLogs%7C%20Hook1%0A%20%20%20%20PV%20-.-%3E%7CupdateAlerts%7C%20Hook2%0A"})]),fallback:t(()=>[...s[0]||(s[0]=[a(" Loading... ",-1)])]),_:1})),s[4]||(s[4]=c(`<h2 id="architecture-layers" tabindex="-1">Architecture Layers <a class="header-anchor" href="#architecture-layers" aria-label="Permalink to &quot;Architecture Layers&quot;">​</a></h2><h3 id="_1-extension-layer-src-extension-ts" tabindex="-1">1. Extension Layer (<code>src/extension.ts</code>) <a class="header-anchor" href="#_1-extension-layer-src-extension-ts" aria-label="Permalink to &quot;1. Extension Layer (\`src/extension.ts\`)&quot;">​</a></h3><ul><li>Entry point for VS Code extension</li><li>Registers <code>vitals.openDashboard</code> command</li><li>Manages extension lifecycle (activate/deactivate)</li></ul><h3 id="_2-webview-management-layer-src-view-ts" tabindex="-1">2. Webview Management Layer (<code>src/View.ts</code>) <a class="header-anchor" href="#_2-webview-management-layer-src-view-ts" aria-label="Permalink to &quot;2. Webview Management Layer (\`src/View.ts\`)&quot;">​</a></h3><ul><li>Creates and manages VS Code webview panel</li><li>Handles IPC communication between extension and React frontend</li><li>Manages commands: <ul><li><code>fetchMetrics</code> → calls Prometheus API</li><li><code>fetchAlerts</code> → retrieves active alerts</li><li><code>fetchLogs</code> → provides mock log data</li></ul></li></ul><h3 id="_3-api-layer-src-api-ts" tabindex="-1">3. API Layer (<code>src/api.ts</code>) <a class="header-anchor" href="#_3-api-layer-src-api-ts" aria-label="Permalink to &quot;3. API Layer (\`src/api.ts\`)&quot;">​</a></h3><ul><li><code>PrometheusApi</code> class for Prometheus communication</li><li>Methods: <ul><li><code>getAlerts()</code> → <code>/api/v1/alerts</code></li><li><code>query(query)</code> → <code>/api/v1/query</code></li></ul></li><li>Error handling and HTTP client setup</li></ul><h3 id="_4-data-processing-src-data" tabindex="-1">4. Data Processing (<code>src/data/</code>) <a class="header-anchor" href="#_4-data-processing-src-data" aria-label="Permalink to &quot;4. Data Processing (\`src/data/\`)&quot;">​</a></h3><ul><li><code>alertProcessor.ts</code> - Evaluates alert thresholds</li><li><code>fetchMetrics.ts</code> - Fetches metrics with config</li></ul><h3 id="_5-react-frontend-webview-src" tabindex="-1">5. React Frontend (<code>webview/src/</code>) <a class="header-anchor" href="#_5-react-frontend-webview-src" aria-label="Permalink to &quot;5. React Frontend (\`webview/src/\`)&quot;">​</a></h3><ul><li><code>App.tsx</code> - Root component</li><li><code>components/</code> - UI components: <ul><li><code>dashboard.tsx</code> - Main layout</li><li><code>MetricChart.tsx</code> - Chart visualization</li><li><code>AlertPanel.tsx</code> - Alert display</li><li><code>LogViewer.tsx</code> - Log stream</li></ul></li><li><code>hooks/</code> - Custom React hooks for data fetching</li></ul><h2 id="data-flow" tabindex="-1">Data Flow <a class="header-anchor" href="#data-flow" aria-label="Permalink to &quot;Data Flow&quot;">​</a></h2><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>User triggers &quot;vitals.openDashboard&quot; command</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>extension.ts registers command → calls View.createOrShow()</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>View.ts creates webview panel</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>React App renders (App.tsx → Dashboard component)</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>Components call hooks (useData, useAlerts)</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>Hooks send IPC messages to extension</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>Extension (View.ts) receives message and calls PrometheusApi</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>PrometheusApi queries Prometheus endpoint</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>Response sent back to webview via IPC</span></span>
<span class="line"><span>        ↓</span></span>
<span class="line"><span>Components update and re-render</span></span></code></pre></div><h2 id="key-dependencies" tabindex="-1">Key Dependencies <a class="header-anchor" href="#key-dependencies" aria-label="Permalink to &quot;Key Dependencies&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Package</th><th>Purpose</th></tr></thead><tbody><tr><td><code>axios</code></td><td>HTTP client for Prometheus API calls</td></tr><tr><td><code>@observablehq/plot</code></td><td>Data visualization library</td></tr><tr><td><code>react</code> &amp; <code>react-dom</code></td><td>UI framework</td></tr><tr><td><code>@types/vscode</code></td><td>VS Code API types</td></tr><tr><td><code>webpack</code></td><td>Module bundler</td></tr><tr><td><code>typescript</code></td><td>Type safety</td></tr></tbody></table><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h2><p>Extension reads from VS Code settings:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;vitals.prometheusUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:9090&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="ipc-message-protocol" tabindex="-1">IPC Message Protocol <a class="header-anchor" href="#ipc-message-protocol" aria-label="Permalink to &quot;IPC Message Protocol&quot;">​</a></h2><p><strong>Webview → Extension:</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fetchMetrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;up&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fetchAlerts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;fetchLogs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div><p><strong>Extension → Webview:</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;updateMetrics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;updateAlerts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;updateLogs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div><h2 id="security" tabindex="-1">Security <a class="header-anchor" href="#security" aria-label="Permalink to &quot;Security&quot;">​</a></h2><ul><li>Content Security Policy enforced in HTML template</li><li>Webview has limited resource roots (only build directory)</li><li>Scripts enabled for React interactivity</li></ul><h2 id="build-distribution" tabindex="-1">Build &amp; Distribution <a class="header-anchor" href="#build-distribution" aria-label="Permalink to &quot;Build &amp; Distribution&quot;">​</a></h2><ul><li><strong>Build</strong>: <code>npm run build</code> (bundles extension + webview)</li><li><strong>Watch</strong>: <code>npm run watch</code> (development mode)</li><li><strong>Publish</strong>: <code>npm run vscode:prepublish</code> then publish to VSCode Marketplace</li></ul>`,27))])}const A=l(k,[["render",u]]);export{v as __pageData,A as default};
